# Recommended minimum configuration

# Set the visible hostname
visible_hostname squid

# Define the port for Squid to listen on
http_port 3128

# Configure access control rules
acl localnet src 172.0.0.0/8  # Adjust this to match your local network subnet
acl SSL_ports port 443
acl Safe_ports port 80       # HTTP
acl Safe_ports port 21       # FTP
acl Safe_ports port 443      # HTTPS
acl Safe_ports port 70       # Gopher
acl Safe_ports port 210      # Wais
acl Safe_ports port 1025-65535  # Unregistered ports
acl Safe_ports port 280      # HTTP-mgmt
acl Safe_ports port 488      # Gss-http
acl Safe_ports port 591      # FileMaker
acl Safe_ports port 777      # Multiling HTTP
acl CONNECT method CONNECT

#authentication Mysql base:
auth_param basic program /usr/lib/squid/basic_db_auth --dsn "DBI:mysql:database=squid_db;host=mysql" --user "squid_user" --password "squid_password" --table "squid_users" --usercol "username" --passwdcol "password" --cond "" --plaintext
auth_param basic children 5
auth_param basic realm Squid proxy-caching web server
auth_param basic credentialsttl 1 hour
auth_param basic casesensitive off
acl authenticated_users proxy_auth REQUIRED
http_access allow authenticated_users


# Define cache settings
cache_mem 8 GB
maximum_object_size 512 MB
maximum_object_size_in_memory 64 KB
cache_replacement_policy heap LFUDA
cache_dir ufs /var/spool/squid 100 16 256

# Enable disk I/O optimization
strip_query_terms off
buffered_logs on

# Configure timeouts
forward_timeout 5 minutes
connect_timeout 30 seconds
peer_connect_timeout 30 seconds
read_timeout 5 minutes
request_timeout 5 minutes
persistent_request_timeout 1 minute

# Enable asynchronous I/O
async-io 32

# Enable logging
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log

# Set other options
forwarded_for on
httpd_suppress_version_string on

# DNS configuration
dns_nameservers 8.8.8.8 1.1.1.1

# Define access rules
http_access allow localnet
http_access allow localhost
http_access deny all

# Disable IPv6 (optional)
dns_v4_first on
