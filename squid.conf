# Recommended minimum configuration

# Set the visible hostname
visible_hostname squid

# Define the port for Squid to listen on
http_port 3128

# Define the cache directory and size
cache_dir ufs /var/spool/squid 10000 16 256

# Set the maximum object size to be cached
maximum_object_size 512 MB

# Enable caching
cache_effective_user proxy
cache_effective_group proxy
cache_mgr admin@localhost

# Logging configuration
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log

# Enable forwarding of X-Forwarded-For headers
forwarded_for on

# Disable IPv6 (optional)
dns_v4_first on

# Increase the maximum number of file descriptors Squid can open
max_filedescriptors 65536

#authentication Mysql base:
auth_param basic program /usr/lib/squid/basic_db_auth --dsn "DBI:mysql:database=squid_db;host=mysql" --user "squid_user" --password "squid_password" --table "squid_users" --usercol "username" --passwdcol "password" --cond "" --plaintext
auth_param basic children 5
auth_param basic realm Squid proxy-caching web server
auth_param basic credentialsttl 1 hour
auth_param basic casesensitive off
acl authenticated_users proxy_auth REQUIRED
http_access allow authenticated_users

# Increase the maximum number of open sockets
max_open_sockets 8192

# Tune TCP settings
client_lifetime 1 day
half_closed_clients off
pconn_timeout 60 seconds
request_timeout 5 minutes
shutdown_lifetime 10 seconds
client_db off

# Tune disk I/O
strip_query_terms off
buffered_logs on
memory_pools off

# Enable asynchronous I/O
async-io 32

# Enable SSL bump for HTTPS traffic (requires additional configuration)
# ssl_bump server-first all

# Adjust the cache memory settings according to your available resources
memory_pools off
cache_mem 8 GB
maximum_object_size_in_memory 64 KB

# Configure access control rules and ACLs as needed
# acl ...

# Configure traffic and concurrency-related settings
# icp_port 0
# query_icmp on
# pipeline_prefetch on
# read_ahead_gap 64 KB
# quick_abort_min 0 KB
# quick_abort_max 0 KB

# Adjust timeout values as needed
# forward_timeout ...
# connect_timeout ...
# peer_connect_timeout ...
# read_timeout ...
# request_timeout ...
# persistent_request_timeout ...

# Enable other features as required
# url_rewrite_program ...
# url_rewrite_children ...
# refresh_pattern ...

# Configure SSL interception (if required)
# ssl_bump ...

# Configure authentication
# auth_param ...
# acl ...

# Configure cache hierarchies (if using multiple Squid instances)
# cache_peer ...

# Configure load balancing (if using multiple Squid instances)
# cache_peer_access ...

# Define your DNS servers
dns_nameservers 8.8.8.8 1.1.1.1

# Define your access control rules
# http_access ...

# Default action is to deny all other requests
http_access deny all
